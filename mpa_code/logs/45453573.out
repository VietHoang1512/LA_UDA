Sun Apr 21 09:58:24 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.154.05             Driver Version: 535.154.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Quadro RTX 8000                On  | 00000000:2F:00.0 Off |                    0 |
| N/A   29C    P8              14W / 250W |      0MiB / 46080MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Namespace(file_root='.', data_root='/vast/hvp2011/data/domainnet/', backbone='RN101', dataset='DomainNet', device='cuda', batch_size=32, num_workers=4, pin_memory=True, threshold=0.4, M1=16, M2=16, mid_dim=384, out_dim=300, prompt_iteration=4000, msf_iteration=2000, prompt_learning_rate=0.003, prompt_momentum=0.9, prompt_weight_decay=0.0001, msf_learning_rate=0.005, msf_alpha=500, output_folder='./DomainNet/RN101/MPA_FINAL', n_cls=345)
===============================================================================================
Layer (type:depth-idx)                                                 Param #
===============================================================================================
Custom_Clip                                                            1
├─ModifiedResNet: 1-1                                                  --
│    └─Conv2d: 2-1                                                     (864)
│    └─BatchNorm2d: 2-2                                                (64)
│    └─ReLU: 2-3                                                       --
│    └─Conv2d: 2-4                                                     (9,216)
│    └─BatchNorm2d: 2-5                                                (64)
│    └─ReLU: 2-6                                                       --
│    └─Conv2d: 2-7                                                     (18,432)
│    └─BatchNorm2d: 2-8                                                (128)
│    └─ReLU: 2-9                                                       --
│    └─AvgPool2d: 2-10                                                 --
│    └─Sequential: 2-11                                                --
│    │    └─Bottleneck: 3-1                                            (75,008)
│    │    └─Bottleneck: 3-2                                            (70,400)
│    │    └─Bottleneck: 3-3                                            (70,400)
│    └─Sequential: 2-12                                                --
│    │    └─Bottleneck: 3-4                                            (379,392)
│    │    └─Bottleneck: 3-5                                            (280,064)
│    │    └─Bottleneck: 3-6                                            (280,064)
│    │    └─Bottleneck: 3-7                                            (280,064)
│    └─Sequential: 2-13                                                --
│    │    └─Bottleneck: 3-8                                            (1,512,448)
│    │    └─Bottleneck: 3-9                                            (1,117,184)
│    │    └─Bottleneck: 3-10                                           (1,117,184)
│    │    └─Bottleneck: 3-11                                           (1,117,184)
│    │    └─Bottleneck: 3-12                                           (1,117,184)
│    │    └─Bottleneck: 3-13                                           (1,117,184)
│    │    └─Bottleneck: 3-14                                           (1,117,184)
│    │    └─Bottleneck: 3-15                                           (1,117,184)
│    │    └─Bottleneck: 3-16                                           (1,117,184)
│    │    └─Bottleneck: 3-17                                           (1,117,184)
│    │    └─Bottleneck: 3-18                                           (1,117,184)
│    │    └─Bottleneck: 3-19                                           (1,117,184)
│    │    └─Bottleneck: 3-20                                           (1,117,184)
│    │    └─Bottleneck: 3-21                                           (1,117,184)
│    │    └─Bottleneck: 3-22                                           (1,117,184)
│    │    └─Bottleneck: 3-23                                           (1,117,184)
│    │    └─Bottleneck: 3-24                                           (1,117,184)
│    │    └─Bottleneck: 3-25                                           (1,117,184)
│    │    └─Bottleneck: 3-26                                           (1,117,184)
│    │    └─Bottleneck: 3-27                                           (1,117,184)
│    │    └─Bottleneck: 3-28                                           (1,117,184)
│    │    └─Bottleneck: 3-29                                           (1,117,184)
│    │    └─Bottleneck: 3-30                                           (1,117,184)
│    └─Sequential: 2-14                                                --
│    │    └─Bottleneck: 3-31                                           (6,039,552)
│    │    └─Bottleneck: 3-32                                           (4,462,592)
│    │    └─Bottleneck: 3-33                                           (4,462,592)
│    └─AttentionPool2d: 2-15                                           102,400
│    │    └─Linear: 3-34                                               (4,196,352)
│    │    └─Linear: 3-35                                               (4,196,352)
│    │    └─Linear: 3-36                                               (4,196,352)
│    │    └─Linear: 3-37                                               (1,049,088)
├─TextEncoder: 1-2                                                     301,568
│    └─Transformer: 2-16                                               --
│    │    └─Sequential: 3-38                                           (37,828,608)
│    └─LayerNorm: 2-17                                                 (1,024)
===============================================================================================
Total params: 94,391,137
Trainable params: 0
Non-trainable params: 94,391,137
===============================================================================================
Custom_Clip ===============================================================================================
Layer (type:depth-idx)                                                 Param #
===============================================================================================
Custom_Clip                                                            1
├─ModifiedResNet: 1-1                                                  --
│    └─Conv2d: 2-1                                                     (864)
│    └─BatchNorm2d: 2-2                                                (64)
│    └─ReLU: 2-3                                                       --
│    └─Conv2d: 2-4                                                     (9,216)
│    └─BatchNorm2d: 2-5                                                (64)
│    └─ReLU: 2-6                                                       --
│    └─Conv2d: 2-7                                                     (18,432)
│    └─BatchNorm2d: 2-8                                                (128)
│    └─ReLU: 2-9                                                       --
│    └─AvgPool2d: 2-10                                                 --
│    └─Sequential: 2-11                                                --
│    │    └─Bottleneck: 3-1                                            (75,008)
│    │    └─Bottleneck: 3-2                                            (70,400)
│    │    └─Bottleneck: 3-3                                            (70,400)
│    └─Sequential: 2-12                                                --
│    │    └─Bottleneck: 3-4                                            (379,392)
│    │    └─Bottleneck: 3-5                                            (280,064)
│    │    └─Bottleneck: 3-6                                            (280,064)
│    │    └─Bottleneck: 3-7                                            (280,064)
│    └─Sequential: 2-13                                                --
│    │    └─Bottleneck: 3-8                                            (1,512,448)
│    │    └─Bottleneck: 3-9                                            (1,117,184)
│    │    └─Bottleneck: 3-10                                           (1,117,184)
│    │    └─Bottleneck: 3-11                                           (1,117,184)
│    │    └─Bottleneck: 3-12                                           (1,117,184)
│    │    └─Bottleneck: 3-13                                           (1,117,184)
│    │    └─Bottleneck: 3-14                                           (1,117,184)
│    │    └─Bottleneck: 3-15                                           (1,117,184)
│    │    └─Bottleneck: 3-16                                           (1,117,184)
│    │    └─Bottleneck: 3-17                                           (1,117,184)
│    │    └─Bottleneck: 3-18                                           (1,117,184)
│    │    └─Bottleneck: 3-19                                           (1,117,184)
│    │    └─Bottleneck: 3-20                                           (1,117,184)
│    │    └─Bottleneck: 3-21                                           (1,117,184)
│    │    └─Bottleneck: 3-22                                           (1,117,184)
│    │    └─Bottleneck: 3-23                                           (1,117,184)
│    │    └─Bottleneck: 3-24                                           (1,117,184)
│    │    └─Bottleneck: 3-25                                           (1,117,184)
│    │    └─Bottleneck: 3-26                                           (1,117,184)
│    │    └─Bottleneck: 3-27                                           (1,117,184)
│    │    └─Bottleneck: 3-28                                           (1,117,184)
│    │    └─Bottleneck: 3-29                                           (1,117,184)
│    │    └─Bottleneck: 3-30                                           (1,117,184)
│    └─Sequential: 2-14                                                --
│    │    └─Bottleneck: 3-31                                           (6,039,552)
│    │    └─Bottleneck: 3-32                                           (4,462,592)
│    │    └─Bottleneck: 3-33                                           (4,462,592)
│    └─AttentionPool2d: 2-15                                           102,400
│    │    └─Linear: 3-34                                               (4,196,352)
│    │    └─Linear: 3-35                                               (4,196,352)
│    │    └─Linear: 3-36                                               (4,196,352)
│    │    └─Linear: 3-37                                               (1,049,088)
├─TextEncoder: 1-2                                                     301,568
│    └─Transformer: 2-16                                               --
│    │    └─Sequential: 3-38                                           (37,828,608)
│    └─LayerNorm: 2-17                                                 (1,024)
===============================================================================================
Total params: 94,391,137
Trainable params: 0
Non-trainable params: 94,391,137
===============================================================================================
**************************************************
Start training on clipart
**************************************************
Start training on infograph
**************************************************
Start training on painting
**************************************************
Start training on quickdraw
Generating pseudo labels for quickdraw data
pseudo label correct rate is 0.1008
Start training clipart to quickdraw prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.10722402597402597
===========================================================================================
Start training infograph to quickdraw prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.10488752319109462
===========================================================================================
Start training painting to quickdraw prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.10215677179962894
===========================================================================================
Start training real to quickdraw prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.09855635435992578
===========================================================================================
Start training sketch to quickdraw prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.10023191094619666
===========================================================================================
Start aligning quickdraw prompts
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
AE_cls =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
AE_domain =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
accuracy is: 0.09256725417439703 with a total of 172480 data
===========================================================================================
**************************************************
Start training on real
**************************************************
Start training on sketch
Generating pseudo labels for sketch data
pseudo label correct rate is 0.5422243059699372
Start training clipart to sketch prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.5300989085948158
===========================================================================================
Start training infograph to sketch prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.547081059572533
===========================================================================================
Start training painting to sketch prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.5503495907230559
===========================================================================================
Start training quickdraw to sketch prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.5648732378353797
===========================================================================================
Start training real to sketch prompt
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,842,624
=================================================================
Total params: 2,842,624
Trainable params: 2,842,624
Non-trainable params: 0
=================================================================
Accuracy is 0.5415956116416553
===========================================================================================
Start aligning sketch prompts
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
AE_cls =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
AE_domain =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
AutoEncoder                              --
├─Linear: 1-1                            153,900
├─Linear: 1-2                            115,584
├─Linear: 1-3                            197,120
=================================================================
Total params: 466,604
Trainable params: 466,604
Non-trainable params: 0
=================================================================
